/* SITE ARCHITECTURE */

Opens directly from filesystem - no web server required.

/* DIRECTORY STRUCTURE */

Each page is an index.html in its own directory. The root _script/jimmyg.js
is shared across all pages. Directories may contain _asset/ for source files.

/* HTML PAGE FORMAT */

Pages contain:
  1. A <script> tag loading the relative path to _script/jimmyg.js
  2. A <noscript> tag with link to sitemap.html (for no-JS browsers)
  3. The body content (starting with an <h1>)

The script injects viewport meta, inline styles, header (breadcrumbs + section
nav), wraps content in <main>, and adds a footer with Top link.

/* LAYOUT */

Single column, full width, browser defaults. Sticky header with backdrop blur.

Breadcrumbs and section nav both left-aligned with gap between.

/* NAVIGATION */

Pages with children are "sections". Pages without children are "leaves".

Breadcrumbs: Path to current section with > separator. All items linked
except current section (plain text). Leaf pages don't add breadcrumb depth.

Section nav: Children of current section. On leaf pages, shows siblings
with current page as plain text. Sections shown in bold.

Footer: Right-aligned Top link, only visible when page is scrollable and
not at top.

/* SITEMAP */

Navigation structure is defined in sitemap/index.html. Run `make sitemap`
to generate _script/sitemap.js which is loaded by jimmyg.js. The sitemap
page appears in navigation like any other page.

/* AUTHORING */

To create a new page:
  1. Create a directory with index.html
  2. Add script tag, noscript tag, and content starting with <h1>
  3. Add the page to sitemap.html
  4. Run `make sitemap`

/* EDITING */

Ctrl+E or ?edit enters edit mode. Content becomes editable in the browser.
The footer is hidden and content is constrained to max 1000px width.

Keyboard shortcuts:
  Ctrl+2/3/4  Heading levels
  Ctrl+0      Paragraph
  Ctrl+L      Bulleted list
  Tab         Indent list item
  Shift+Tab   Dedent list item
  Ctrl+K      Add/edit link (select text first, prompt for URL, empty to remove)
  Ctrl+B      Bold/strong (select text first)
  Ctrl+I      Italic/em (text selected) or image alt text (image selected)

Selection in JS: Text selection returns content via selection.toString().
Image selection brackets the element within its parent - the range's
startContainer equals endContainer, and endOffset - startOffset equals 1,
with the image at childNodes[startOffset].

Drag and drop images onto page to insert. Images show as previews and are
referenced by SHA256 hash (first 12 chars) as _gallery/HASH.jpg. Image
dimensions are stored as data-width and data-height attributes.

Image rows: Images on the same line form a gallery row. Press Enter between
images to create separate rows. The saved HTML preserves line breaks which
jimmyg.js uses to build the gallery table.

Saving:
  "Copy HTML" - copies formatted HTML to clipboard via navigator.clipboard API
  "Save" - creates a Blob with text/html content, generates a temporary URL
           via URL.createObjectURL(), triggers download via anchor click.
           Right-click and "Save As" to choose location.
  "View" - exits edit mode (navigates to page without ?edit)

/* IMAGE GALLERIES */

Consecutive <img> tags form a row. The script wraps them in a flex container
with equal widths. Separate rows with any block element (p, h2, etc).

/* IMAGE PROCESSING */

Images are content-addressed by SHA256 hash. Workflow:

  1. `make index`   - scans ~/Pictures, builds ~/.cache/picture-index
  2. Drag images in edit mode - computes hash, inserts _gallery/HASH.jpg
  3. `make gallery` - finds hashes in HTML, generates thumbnails from index

Generates 300, 600, 1200, 2400px sizes. The base HASH.jpg symlinks to 1200px.
Requires ImageMagick (convert command).

jimmyg.js adds srcset to gallery images so the browser picks the right size.

/* NO-JS FALLBACK */

Each page includes a <noscript> link to sitemap.html. Browsers without
JavaScript (lynx, w3m, links, elinks) can navigate via the sitemap.
